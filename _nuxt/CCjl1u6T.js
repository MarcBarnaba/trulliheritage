import{a as X,_ as ee}from"./CIFfK06x.js";import{d as B,E as L,r as x,j as se,c as i,o as r,b as $,a as e,q as A,u as l,F as v,v as b,z as E,t,_ as te,A as le,s as oe,B as j,H as Y,R as z,S as ae,I as ne,J as re,K as ie,L as Z,l as ce}from"./BaYs-Ej0.js";import{u as de}from"./CiPnCjr6.js";import{a as ue,u as me,q as pe}from"./CwbN462v.js";const _e={class:"w-full relative mb-4"},he={class:"col-span-1 flex-col w-full"},ge={class:"col-span-1 flex-col w-full"},ve={key:0,class:"absolute bottom-0 left-0 right-0 h-48 bg-gradient-to-t from-white to-transparent pointer-events-none"},be={key:1,class:"absolute -bottom-2 left-0 right-0 flex justify-center z-10 mb-2"},fe={class:"material-icons"},xe=B({__name:"ImgGrid",props:{images:{},showMorePath:{}},setup(O){const n=O,{t:g}=L(),c=x(!1),m=x(null),_=se(()=>n.images),h=()=>{c.value=!c.value,!c.value&&m.value&&setTimeout(()=>{m.value.scrollIntoView({behavior:"smooth",block:"start"})},100)};return(u,f)=>{const w=X,y=te;return r(),i("div",_e,[$(w,{align:"left",class:"px-8",title:l(g)("gallery"),titleSize:"2xl"},null,8,["title"]),e("div",{ref_key:"gridContainer",ref:m,class:E(["grid grid-cols-1 lg:grid-cols-2 gap-2 transition-all duration-300",!l(c)&&u.images.length>4?"max-h-[500px] md:max-h-[600px] overflow-hidden":""])},[e("div",he,[(r(!0),i(v,null,b(l(_).filter((o,s)=>s%4===0||s%4===1),(o,s)=>(r(),i("div",{key:"col1-"+s,class:E([s%2===0?"aspect-w-16":"aspect-w-9","overflow-hidden w-full"])},[$(y,{src:o,alt:`Trullo Img #${s}`,class:"object-cover w-full h-full pb-2"},null,8,["src","alt"])],2))),128))]),e("div",ge,[(r(!0),i(v,null,b(l(_).filter((o,s)=>s%4===2||s%4===3),(o,s)=>(r(),i("div",{key:"col2-"+s,class:E([s%2!==0?"aspect-w-16":"aspect-w-9","overflow-hidden w-full"])},[$(y,{src:o,alt:`Trullo Img #${s}`,class:"object-cover w-full h-full pb-2"},null,8,["src","alt"])],2))),128))])],2),!l(c)&&u.images.length>4?(r(),i("div",ve)):A("",!0),u.images.length>4?(r(),i("div",be,[e("button",{onClick:h,class:"flex items-center bg-white border border-gray-300 text-teal-600 hover:text-teal-800 hover:bg-gray-100 py-4 px-4 rounded-full transition shadow-sm"},[e("span",fe,t(l(c)?"expand_less":"expand_more"),1)])])):A("",!0)])}}}),ye=le(xe,[["__scopeId","data-v-e59cd1fa"]]),we={class:""},ke={class:"relative h-64 md:h-80 overflow-hidden"},$e=["src"],Ie={class:"absolute bottom-0 left-0 w-full p-8 text-white"},Ce={class:"container"},Se={class:"text-3xl md:text-4xl font-bold"},Te={class:"flex items-center mt-2"},Ae={class:"flex items-center"},Oe={class:"ml-1"},De={class:"flex items-center"},Ve={class:"ml-1"},Ee={class:"container mx-auto px-8 pb-8"},je={class:"grid grid-cols-1 lg:grid-cols-3 gap-8"},ze={class:"lg:col-span-2"},Be={class:"text-2xl font-semibold mb-6"},Le={class:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8"},Ne={class:"border rounded-lg p-4"},Pe={class:"text-lg font-medium mb-4"},Re={class:"space-y-3"},Me={class:"material-icons text-gray-600 mr-2"},Ue={class:"border rounded-lg p-4"},He={class:"text-lg font-medium mb-4"},qe={class:"space-y-3"},Fe={class:"material-icons text-gray-600 mr-2"},Ge={class:"border rounded-lg p-4"},Ke={class:"text-lg font-medium mb-4"},We={class:"space-y-3"},Je={class:"material-icons text-gray-600 mr-2"},Qe={class:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8"},Ye={class:"text-xl font-semibold mb-4"},Ze={class:"space-y-2"},Xe={class:"material-icons text-gray-600 mr-2 mt-0.5"},es={class:"text-xl font-semibold mb-4"},ss={class:"space-y-2"},ts={class:"col-span-full"},ls={class:"text-xl font-semibold mb-4"},os={class:"flex items-center mb-4"},as=["src","alt"],ns={class:"font-medium"},rs={class:"text-sm text-gray-600"},is={class:"text-gray-700"},cs={key:0,class:"mb-8"},ds={class:"text-xl font-semibold mb-4"},us=["src"],ms={class:"container mx-auto"},ps={class:"text-xl font-semibold mb-4"},_s={class:"mt-6 grid md:grid-cols-3 gap-6"},hs={class:"text-gray-600 italic"},gs={class:"mt-4 font-bold"},vs={class:"bg-white rounded-lg shadow-md p-6 sticky top-[100px]"},bs={class:"border rounded-lg overflow-hidden mb-4"},fs={class:"grid grid-cols-2"},xs={class:"p-3 border-r border-b"},ys={class:"p-3 border-b"},ws={class:"p-3 border-r col-span-2"},ks=["value"],$s={class:"material-icons mr-2"},Is={class:"font-medium"},Cs=["disabled"],Ss=["href"],Ts=B({__name:"Trullo",props:{trullo:{}},setup(O){const{t:n}=L(),g=O,c=x(new Date().toISOString().split("T")[0]),m=x(new Date(Date.now()+7*24*60*60*1e3).toISOString().split("T")[0]),_=x("2"),h=x(!0),u=x(null),f=x(!1),w=async()=>{var o,s,k,D,V,I,C,S;f.value=!0;try{const{data:d,error:T}=await de("/api/checkAvailability",{method:"POST",body:{checkIn:c.value,checkOut:m.value,guests:_.value,trullo:{slug:g.trullo.slug},findAlternatives:h.value}},"$7RBZsOPW3l");if(T.value)throw T.value;!((o=d.value)!=null&&o.body.available)&&((s=d.value)!=null&&s.body.message)&&console.info(`Struttura non disponibile. Message: ${(k=d.value)==null?void 0:k.body.message}`),(D=d.value)!=null&&D.body.alternativeDates&&console.info(`Alternative dates: ${(V=d.value)==null?void 0:V.body.alternativeDates.checkIn} - ${(I=d.value)==null?void 0:I.body.alternativeDates.checkOut}`),u.value={available:((C=d.value)==null?void 0:C.body.available)??!1,message:(S=d.value)!=null&&S.body.available?n("checkAvailability.success"):n("checkAvailability.failure")}}catch(d){console.error("Errore durante la verifica della disponibilità:",d),u.value={available:!1,message:n("checkAvailability.error")}}finally{f.value=!1}},y=()=>{const o=encodeURIComponent(`Ciao ${g.trullo.owner.name}, sono interessato al tuo "${g.trullo.name}" dal ${c.value} al ${m.value} per ${_.value} ospiti. È disponibile?`);return`https://wa.me/${g.trullo.owner.phone.replace(/\+/g,"")}?text=${o}`};return(o,s)=>{var I,C,S,d,T,N,P,R,M,U,H,q,F,G,K,W,J,Q;const k=ee,D=X,V=ye;return r(),i("div",we,[e("section",ke,[e("img",{src:((I=o.trullo)==null?void 0:I.coverImage)||"/api/placeholder/1200/400",alt:"Trullo",class:"w-full h-full object-cover"},null,8,$e),s[7]||(s[7]=e("div",{class:"absolute inset-0 bg-gradient-to-b from-transparent to-black/60"},null,-1)),e("div",Ie,[e("div",Ce,[e("h1",Se,t((C=o.trullo)==null?void 0:C.name),1),e("div",Te,[e("span",Ae,[s[3]||(s[3]=e("span",{class:"material-icons text-amber-400 text-sm"},"star",-1)),e("span",Oe,t((S=o.trullo)==null?void 0:S.rating),1),s[4]||(s[4]=e("span",{class:"mx-1"},"·",-1)),e("span",null,t((d=o.trullo)==null?void 0:d.reviewsCount)+" "+t(l(n)("reviews")),1)]),s[6]||(s[6]=e("span",{class:"mx-3"},"|",-1)),e("span",De,[s[5]||(s[5]=e("span",{class:"material-icons text-white text-sm"},"location_on",-1)),e("span",Ve,t((T=o.trullo)==null?void 0:T.location),1)])])])])]),$(D,{class:"px-8",align:"left",title:l(n)("description"),paragraph:(N=o.trullo)==null?void 0:N.description,"title-size":"2xl"},{default:oe(()=>[$(k)]),_:1},8,["title","paragraph"]),$(V,{images:(P=o.trullo)==null?void 0:P.images,class:"py-8"},null,8,["images"]),e("div",Ee,[e("div",je,[e("div",ze,[e("section",null,[e("h2",Be,t(l(n)("features")),1),e("div",Le,[e("div",Ne,[e("h3",Pe,t(l(n)("nightInfo")),1),e("ul",Re,[(r(!0),i(v,null,b((R=o.trullo)==null?void 0:R.nightInfo,(a,p)=>(r(),i("li",{key:`night-${p}`,class:"flex items-center"},[e("span",Me,t(a.icon),1),e("span",null,t(a.text),1)]))),128))])]),e("div",Ue,[e("h3",He,t(l(n)("services")),1),e("ul",qe,[(r(!0),i(v,null,b((M=o.trullo)==null?void 0:M.services,(a,p)=>(r(),i("li",{key:`service-${p}`,class:"flex items-center"},[e("span",Fe,t(a.icon),1),e("span",null,t(a.text),1)]))),128))])]),e("div",Ge,[e("h3",Ke,t(l(n)("amenities")),1),e("ul",We,[(r(!0),i(v,null,b((U=o.trullo)==null?void 0:U.amenities,(a,p)=>(r(),i("li",{key:`amenity-${p}`,class:"flex items-center"},[e("span",Je,t(a.icon),1),e("span",null,t(a.text),1)]))),128))])])])]),e("section",null,[e("div",Qe,[e("div",null,[e("h3",Ye,t(l(n)("rules")),1),e("ul",Ze,[(r(!0),i(v,null,b((H=o.trullo)==null?void 0:H.rules,(a,p)=>(r(),i("li",{key:`rule-${p}`,class:"flex items-start"},[e("span",Xe,t(a.allowed?"check_circle":"cancel"),1),e("span",null,t(a.text),1)]))),128))])]),e("div",null,[e("h3",es,t(l(n)("usefulInfo")),1),e("ul",ss,[(r(!0),i(v,null,b((q=o.trullo)==null?void 0:q.usefulInfo,(a,p)=>(r(),i("li",{key:`info-${p}`,class:"flex items-start"},[s[8]||(s[8]=e("span",{class:"material-icons text-gray-600 mr-2 mt-0.5"},"info",-1)),e("span",null,t(a.text),1)]))),128))])]),e("div",ts,[e("h3",ls,t(l(n)("propertyInfo")),1),e("div",os,[e("img",{src:((F=o.trullo)==null?void 0:F.owner.avatar)||"https://avatar.iran.liara.run/public/5",alt:l(n)("host"),class:"w-12 h-12 rounded-full mr-3"},null,8,as),e("div",null,[e("p",ns,t((G=o.trullo)==null?void 0:G.owner.name),1),e("p",rs,t(l(n)("host"))+" "+t((K=o.trullo)==null?void 0:K.owner.since),1)])]),e("p",is,t((W=o.trullo)==null?void 0:W.owner.description),1)])]),o.trullo.mapsSrc?(r(),i("div",cs,[e("h3",ds,t(l(n)("position")),1),e("iframe",{id:"map",src:o.trullo.mapsSrc,width:"100%",height:"300",style:{border:"0"},loading:"lazy",referrerpolicy:"no-referrer-when-downgrade"},null,8,us)])):A("",!0),e("section",ms,[e("h3",ps,t(l(n)("testimonials")),1),e("div",_s,[(r(!0),i(v,null,b((J=o.trullo)==null?void 0:J.testimonials,(a,p)=>(r(),i("div",{key:`testimonial-${p}`,class:"bg-white p-6 rounded-lg shadow-md"},[e("p",hs,'"'+t(a.text)+'"',1),e("h4",gs,"- "+t(a.name),1)]))),128))])])])]),e("div",null,[e("div",vs,[e("div",bs,[e("div",fs,[e("div",xs,[s[9]||(s[9]=e("label",{class:"block text-xs text-gray-600 mb-1"},"CHECK-IN",-1)),j(e("input",{type:"date",class:"w-full border-none p-0 focus:ring-0","onUpdate:modelValue":s[0]||(s[0]=a=>z(c)?c.value=a:null)},null,512),[[Y,l(c)]])]),e("div",ys,[s[10]||(s[10]=e("label",{class:"block text-xs text-gray-600 mb-1"},"CHECK-OUT",-1)),j(e("input",{type:"date",class:"w-full border-none p-0 focus:ring-0","onUpdate:modelValue":s[1]||(s[1]=a=>z(m)?m.value=a:null)},null,512),[[Y,l(m)]])]),e("div",ws,[s[11]||(s[11]=e("label",{class:"block text-xs text-gray-600 mb-1"},"OSPITI",-1)),j(e("select",{class:"w-full border-none p-0 focus:ring-0","onUpdate:modelValue":s[2]||(s[2]=a=>z(_)?_.value=a:null)},[(r(!0),i(v,null,b(((Q=o.trullo)==null?void 0:Q.maxGuests)||1,a=>(r(),i("option",{key:a,value:a},t(a)+" "+t(a===1?"ospite":"ospiti"),9,ks))),128))],512),[[ae,l(_)]])])])]),l(u)?(r(),i("div",{key:0,class:E(["p-4 mb-4 rounded-lg flex items-start",l(u).available?"bg-green-100 text-green-800 border border-green-200":"bg-red-100 text-red-800 border border-red-200"])},[e("span",$s,t(l(u).available?"check_circle":"error"),1),e("div",null,[e("p",Is,t(l(u).message),1)])],2)):A("",!0),e("button",{class:"w-full bg-teal-600 hover:bg-teal-700 text-white py-3 rounded-lg font-medium transition mb-3",onClick:w,disabled:l(f)},t(l(f)?l(n)("checkLoading"):l(n)("checkAvailability.btnLabel")),9,Cs),e("a",{href:y(),target:"_blank",class:"w-full flex items-center justify-center bg-emerald-500 hover:bg-emerald-600 text-black py-3 rounded-lg font-medium transition"},[s[12]||(s[12]=e("span",{class:"material-icons mr-2"},"call",-1)),ne(" "+t(l(n)("contactHost")),1)],8,Ss)])])])])])}}}),Es=B({__name:"[slug]",async setup(O){var f,w,y;let n,g;const c=re(),{locale:m}=L(),_=c.params.slug,{data:h,error:u}=([n,g]=ie(()=>me(c.path,()=>pe(`${m.value}_trulli`).where("slug","=",String(_)).first(),"$5lwYO4pdQx")),n=await n,g(),n);if(u.value)throw Z({statusCode:500});if(!h.value)throw Z({statusCode:404});return ue({title:(f=h.value)==null?void 0:f.title,description:(w=h.value)==null?void 0:w.description,ogImage:(y=h.value)==null?void 0:y.coverImage}),(o,s)=>{const k=Ts;return l(h)?(r(),ce(k,{key:0,trullo:l(h)},null,8,["trullo"])):A("",!0)}}});export{Es as default};
